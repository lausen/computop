<?xml version="1.0"?>
<database xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          name="zed" xsi:noNamespaceSchemaLocation="http://static.spryker.com/schema-01.xsd"
          namespace="Orm\Zed\Computop\Persistence"
          namespaceAutoPackage="false"
          package="src.Orm.Zed.Computop.Persistence">

    <table name="spy_payment_computop" phpName="SpyPaymentComputop">
        <column name="id_payment_computop" required="true" type="INTEGER" autoIncrement="true" primaryKey="true"/>
        <column name="fk_sales_order" required="true" type="INTEGER"/>

        <column name="client_ip" required="true" type="VARCHAR"/>
        <column name="payment_method" required="true" type="VARCHAR"/>
        <column name="reference" required="true" type="VARCHAR"/>
        <column name="x_id" type="VARCHAR"/>
        <column name="pay_id" type="VARCHAR"/>
        <column name="trans_id" type="VARCHAR"/>
        <column name="pcnr" type="VARCHAR"/>

        <foreign-key name="spy_payment_computop-fk_sales_order" foreignTable="spy_sales_order" phpName="SpySalesOrder">
            <reference foreign="id_sales_order" local="fk_sales_order"/>
        </foreign-key>

        <index name="spy_payment_computop-index-x_id">
            <index-column name="x_id" />
        </index>

        <unique name="spy_payment_computop-unique-reference">
            <unique-column name="reference" />
        </unique>

        <behavior name="timestampable"/>
        <id-method-parameter value="spy_payment_computop_pk_seq"/>
    </table>


    <table name="spy_payment_computop_detail" phpName="SpyPaymentComputopDetail">
        <column name="id_payment_computop" required="true" type="INTEGER" primaryKey="true"/>

        <column name="m_id" required="false" type="VARCHAR"/>
        <column name="description" required="false" type="VARCHAR"/>
        <column name="mac" required="false" type="VARCHAR"/>
        <column name="c_c_brand" required="false" type="VARCHAR"/>
        <column name="c_c_expiry" required="false" type="VARCHAR"/>
        <column name="masked_pan" required="false" type="VARCHAR"/>
        <column name="cavv" required="false" type="VARCHAR"/>
        <column name="eci" required="false" type="VARCHAR"/>
        <column name="type" required="false" type="VARCHAR"/>
        <column name="plain" required="false" type="VARCHAR"/>

        <column name="ref_nr" required="false" type="VARCHAR"/>
        <column name="a_id" required="false" type="VARCHAR" comment="Only in the case of Card Complete"/>
        <column name="amount" required="false" type="VARCHAR" comment="Only with Clearhaus: Amount in the smallest currency unit (e.g. EUR Cent)
If the actual amount differs from the requested amount this will be returned."/>
        <column name="code_ext" required="false" type="VARCHAR" comment="Only with Clearhaus"/>
        <column name="error_text" required="false" type="VARCHAR" comment="Only with Clearhaus"/>
        <column name="transaction_id" required="false" type="VARCHAR" comment="Only with Clearhaus"/>

        <column name="amount_auth" required="false" type="VARCHAR" comment="Only for Inquire Request"/>
        <column name="amount_cap" required="false" type="VARCHAR" comment="Only for Inquire Request"/>
        <column name="amount_cred" required="false" type="VARCHAR" comment="Only for Inquire Request"/>

        <foreign-key name="spy_payment_computop_detail-id_payment_computop" foreignTable="spy_payment_computop" phpName="SpyPaymentComputop">
            <reference foreign="id_payment_computop" local="id_payment_computop"/>
        </foreign-key>
    </table>


    <table name="spy_payment_computop_api_log">
        <column name="id_payment_compitop_api_log" required="true" type="INTEGER" primaryKey="true" autoIncrement="true"/>
        <column name="method" required="false" type="VARCHAR" />
        <column name="status" required="false" type="VARCHAR"/>
        <column name="code" required="true" type="INTEGER" />
        <column name="description" required="false" type="VARCHAR"/>
        <column name="trans_id" required="false" type="VARCHAR"/>
        <column name="pay_id" required="false" type="VARCHAR"/>
        <column name="x_id" required="false" type="VARCHAR"/>
        <column name="m_id" required="false" type="VARCHAR"/>

        <behavior name="timestampable"/>

        <index name="spy_payment_computop_api_log-index-x_id">
            <index-column name="x_id" />
        </index>

        <id-method-parameter value="spy_payment_computop_api_log_pk_seq"/>
    </table>


    <table name="spy_payment_computop_order_item">
        <column name="fk_payment_computop" type="INTEGER" primaryKey="true"/>
        <column name="fk_sales_order_item" type="INTEGER" primaryKey="true"/>
        <column name="status" required="true" type="VARCHAR"/>

        <behavior name="timestampable"/>

        <foreign-key name="spy_computop_order_item-fk_computop" foreignTable="spy_payment_computop">
            <reference foreign="id_payment_computop" local="fk_payment_computop"/>
        </foreign-key>

        <foreign-key name="spy_payment_computop_order_item-fk_sales_order_item" foreignTable="spy_sales_order_item">
            <reference foreign="id_sales_order_item" local="fk_sales_order_item"/>
        </foreign-key>
    </table>

</database>